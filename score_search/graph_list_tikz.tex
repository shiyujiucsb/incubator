\draw (0,0) circle (.3);
\node at (0,0) {$\tau_1$};
\node [above] at (0,.3) {$\omega_1$};
\draw (2,0) circle (.3);
\node at (2,0) {$\tau_2$};
\node [below] at (2.1,-.3) {$\omega_1$, $\omega_3$};
\draw (1,2) circle (.3);
\node at (1,2) {$\tau_3$};
\node [above] at (1,2.3) {$\omega_1$, $\omega_2$};
\draw (1,-1) circle(.3);
\node at (1,-1) {$\tau_4$};
\node [left] at (.7,-1) {$\omega_3$};
\draw [->] (.2,.3) -- (.8,1.7);
\draw [->] (1.2,1.7) -- (1.8,.3);
\draw [->] (.35,0) -- (1.65,0);
\draw [->] (1.3,-.7) -- (1.7,-.3);
\draw [<->] (.7,-.7) -- (.3,-.3);


\draw (3,0) rectangle (4,.5);
\node at (3.5,.25) {\footnotesize$H(\omega_3)$}; 
\draw [->] (4,.25) -- (4.5,.25);
\node [right] at (4.5,.25) {$\cdots$};
\draw (3,.5) rectangle (4,1);
\node at (3.5,.75) {\footnotesize$H(\omega_2)$};
\draw [->] (4,.75) -- (4.5,.75);
\node [right] at (4.5,.75) {$\cdots$}; 
\draw (3,1) rectangle (4,1.5);
\node at (3.5,1.25) {\footnotesize$H(\omega_1)$}; 
\draw [->] (4,1.25) -- (5.2,1.25);
\draw (5.2,1) rectangle (6.4,1.5);
\node at (5.8,1.25) {\footnotesize$\Enc(\tau_1)$};
\draw (6.4,1) rectangle (7.6,1.5);
\node at (7,1.25) {\footnotesize$\Enc(\tau_2)$};
\draw (7.6,1) rectangle (8.8,1.5);
\node at (8.2,1.25) {\footnotesize$\Enc(\tau_3)$};

\draw (5.2, 0) rectangle (6.6,.5);
\node at (5.9,.25) {\footnotesize$\Enc(e_{12})$};
\draw (5.2, -.5) rectangle (6.6,0);
\node at (5.9,-.25) {\footnotesize$\Enc(e_{13})$};
\draw (7.6, 0) rectangle (9, .5);
\node at (8.3,.25) {\footnotesize$\Enc(e_{32})$};
\draw (7.6, -.5) rectangle (9, 0);
\node at (8.3,-.25) {\footnotesize random};

\draw [thick](5.8, 1) -- (5.8,.5);
\draw [thick](7.1, 1) -- (7.1,.5);
\node at (7.1,.25) {$\cdots$};
\node at (7.1,-.25) {$\cdots$};
\draw [thick](8.2, 1) -- (8.2,.5);